<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>FORMULÁRIO  - Tratamento de Incidentes de Segurança</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --cor-primaria: #2c3e50;
            --cor-secundaria: #34495e;
            --cor-destaque: #e74c3c;
            --cor-sucesso: #27ae60;
            --cor-alerta: #f39c12;
            --cor-info: #3498db;
            --cor-fundo: #f5f7fa;
            --cor-borda: #bdc3c7;
            --cor-texto: #2c3e50;
        }
        
        body { 
            font-family: 'Roboto', sans-serif; 
            background-color: var(--cor-fundo); 
            padding: 20px; 
            margin: 0;
            color: var(--cor-texto);
        }
        
        .container { 
            max-width: 1200px; 
            margin: auto; 
            background: #ffffff; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.08); 
        }
        
        .header {
            background: linear-gradient(135deg, var(--cor-primaria), var(--cor-secundaria));
            color: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .header h1 { 
            margin: 0; 
            font-weight: 400; 
            font-size: 0.95em;
            letter-spacing: 0.5px;
        }
        
        .header-subtitle {
            font-size: 0.95em;
            opacity: 0.9;
            margin-top: 8px;
            font-weight: 300;
        }
        
        .introducao { 
            color: var(--cor-texto); 
            margin-bottom: 30px; 
            font-size: 14px; 
            line-height: 1.6; 
            border-left: 4px solid var(--cor-info); 
            padding-left: 20px; 
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
        }
        
        .section { 
            margin-bottom: 30px; 
            border: 1px solid var(--cor-borda); 
            border-radius: 8px; 
            padding: 25px; 
            background-color: #fff; 
            transition: all 0.3s ease;
        }
        
        .section:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .section-header { 
            background: linear-gradient(135deg, var(--cor-primaria), var(--cor-secundaria));
            color: white; 
            padding: 15px 20px; 
            margin: -25px -25px 25px -25px; 
            border-radius: 8px 8px 0 0; 
            font-weight: 600; 
            font-size: 14px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-header i {
            font-size: 1.2em;
        }
        
        .grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
        }
        
        .grid-3 { 
            display: grid; 
            grid-template-columns: 1fr 1fr 1fr; 
            gap: 20px; 
        }
        
        .full-width { 
            grid-column: span 2; 
        }
        
        .full-width-3 { 
            grid-column: span 3; 
        }
        
        label { 
            display: block; 
            font-weight: 600; 
            margin-bottom: 8px; 
            color: var(--cor-texto); 
            font-size: 13px; 
        }
        
        .label-required:after {
            content: " *";
            color: var(--cor-destaque);
        }
        
        select, input, textarea { 
            width: 100%; 
            padding: 12px 15px; 
            border: 1px solid var(--cor-borda); 
            border-radius: 6px; 
            box-sizing: border-box; 
            background: #fff; 
            font-size: 14px;
            font-family: 'Roboto', sans-serif;
            transition: border 0.3s;
        }
        
        .nome-input {
            width: 100%; 
            padding: 8px 12px; 
            border: 1px solid var(--cor-borda); 
            border-radius: 4px; 
            font-size: 14px;
            font-family: 'Roboto', sans-serif;
            transition: border 0.3s;
        }
        
        .nome-input:focus {
            outline: none;
            border-color: var(--cor-info);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        select:focus, input:focus, textarea:focus {
            outline: none;
            border-color: var(--cor-info);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }
        
        /* Estilo para as Caixas de Mitigação Específicas */
        .mitigation-panel {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 20px;
            border-radius: 6px;
            margin-top: 15px;
            transition: all 0.3s;
        }
        
        .mitigation-panel:hover {
            background: #f1f3f5;
            border-color: var(--cor-info);
        }
        
        .mitigation-title {
            font-weight: 700;
            color: var(--cor-primaria);
            margin-bottom: 15px;
            display: block;
            border-bottom: 2px solid var(--cor-info);
            padding-bottom: 8px;
            font-size: 13px;
            text-transform: uppercase;
            display: flex;
            align-items: center;
        }
        
        .mitigation-title i {
            margin-right: 10px;
            font-size: 1.1em;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: flex-start;
            font-size: 13px;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background 0.2s;
        }
        
        .checkbox-item:hover {
            background: rgba(52, 152, 219, 0.05);
        }
        
        .checkbox-item input {
            width: auto;
            margin-right: 12px;
            margin-top: 3px;
        }
        
        /* Estilos para profissionais e responsabilidades */
        .profissionais-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .profissional-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 15px;
            position: relative;
        }
        
        .profissional-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .profissional-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--cor-info), #2980b9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            color: white;
            font-size: 1.2em;
        }
        
        .profissional-nome {
            font-weight: 600;
            color: var(--cor-primaria);
            font-size: 14px;
            flex: 1;
        }
        
        .profissional-funcao {
            font-size: 12px;
            color: #6c757d;
            margin-top: 2px;
        }
        
        .profissional-tarefas {
            font-size: 12px;
            line-height: 1.5;
        }
        
        .profissional-tarefas ul {
            margin: 8px 0 0 0;
            padding-left: 20px;
        }
        
        .profissional-tarefas li {
            margin-bottom: 5px;
        }
        
        /* Timestamps e linha do tempo */
        .timeline-container {
            position: relative;
            padding-left: 30px;
            margin-top: 20px;
        }
        
        .timeline-container:before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--cor-info);
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
        }
        
        .timeline-item:before {
            content: '';
            position: absolute;
            left: -24px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--cor-info);
            border: 2px solid white;
            box-shadow: 0 0 0 3px var(--cor-info);
        }
        
        .timeline-time {
            font-weight: 600;
            font-size: 12px;
            color: var(--cor-primaria);
            display: flex;
            align-items: center;
        }
        
        .timeline-time i {
            margin-right: 8px;
            color: var(--cor-info);
        }
        
        .timeline-description {
            font-size: 13px;
            margin-top: 5px;
            color: #555;
        }
        
        /* Itens de Ação */
        .action-items-container {
            margin-top: 15px;
        }
        
        .action-item {
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid var(--cor-destaque);
        }
        
        /* Botões */
        .btn-container { 
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 40px; 
            padding-top: 25px; 
            border-top: 1px solid #eee; 
        }
        
        .btn-group {
            display: flex;
            gap: 15px;
        }
        
        button { 
            padding: 14px 30px; 
            font-size: 14px; 
            border: none; 
            border-radius: 6px; 
            cursor: pointer; 
            color: white; 
            font-weight: 600; 
            transition: all 0.3s; 
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-small {
            padding: 8px 15px;
            font-size: 12px;
        }
        
        .btn-clear { 
            background-color: #95a5a6; 
        }
        
        .btn-clear:hover { 
            background-color: #7f8c8d; 
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(149, 165, 166, 0.3);
        }
        
        .btn-relatorio { 
            background: linear-gradient(135deg, var(--cor-sucesso), #219653); 
        }
        
        .btn-relatorio:hover { 
            background: linear-gradient(135deg, #219653, var(--cor-sucesso));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
        
        .btn-add {
            background: linear-gradient(135deg, var(--cor-info), #2980b9);
            padding: 10px 20px;
            font-size: 13px;
        }
        
        .btn-add:hover {
            background: linear-gradient(135deg, #2980b9, var(--cor-info));
            transform: translateY(-2px);
        }
        
        .btn-remove {
            background: var(--cor-destaque);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .btn-remove:hover {
            background: #c0392b;
        }
        
        /* Indicadores de status */
        .status-indicator {
            display: inline-flex;
            align-items: center;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-critical {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--cor-destaque);
            border: 1px solid rgba(231, 76, 60, 0.2);
        }
        
        .status-high {
            background-color: rgba(243, 156, 18, 0.1);
            color: var(--cor-alerta);
            border: 1px solid rgba(243, 156, 18, 0.2);
        }
        
        .status-medium {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--cor-info);
            border: 1px solid rgba(52, 152, 219, 0.2);
        }
        
        .status-resolved {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--cor-sucesso);
            border: 1px solid rgba(39, 174, 96, 0.2);
        }
        
        /* Responsividade */
        @media (max-width: 992px) {
            .grid, .grid-3 {
                grid-template-columns: 1fr;
            }
            
            .full-width, .full-width-3 {
                grid-column: span 1;
            }
            
            .btn-container {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn-group {
                width: 100%;
                justify-content: space-between;
            }
            
            button {
                flex: 1;
            }
            
            .profissionais-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media print {
            .btn-container, .introducao { display: none; }
            body { background-color: white; padding: 0; }
            .container { box-shadow: none; border: none; max-width: 100%; }
            .section { break-inside: avoid; border: 1px solid #000; }
            input, textarea, select { border: 1px solid #000 !important; }
            .mitigation-panel { background: white !important; border: 1px solid #eee; }
            .profissionais-container { grid-template-columns: 1fr 1fr; }
        }
        
        /* Animações */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(-10px); }
        }
        
        .section {
            animation: fadeIn 0.5s ease-out;
        }
        
        .mitigation-panel {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body>

<form id="incidentForm">
<div class="container">
    
    <div class="header">
        <h1>REGISTRO - Tratamento de Incidente de Segurança- DoS/DDoS</h1>
        <div class="header-subtitle">UFRGS | Time de Resposta a Incidentes de Segurança (TRI)</div>
    </div>
    
    <div class="introducao">
        <strong></strong> Este formulário operacional avançado documenta todas as etapas da resposta a incidentes DDoS na UFRGS, 
        incluindo responsabilidades técnicas, timestamps precisos e ações específicas por categoria profissional. 
        <strong>Todos os campos marcados com * são obrigatórios.</strong>
    </div>

    <!-- SEÇÃO 1: IDENTIFICAÇÃO DO INCIDENTE -->
    <div class="section">
        <div class="section-header">
            <span><i class="fas fa-search"></i> IDENTIFICAÇÃO E CLASSIFICAÇÃO DO INCIDENTE</span>
            <span class="status-indicator status-critical">CLASSIFICAÇÃO EM ANDAMENTO</span>
        </div>
        <div class="grid-3">
            
            <div class="form-group">
                <label class="label-required">ID do Incidente</label>
                <input type="text" id="id-incidente" placeholder="Ex: INC-DDoS-2024-001" value="" required>
            </div>
            <div class="form-group">
                <label class="label-required">Timestamp da Primeira Detecção</label>
                <input type="datetime-local" id="timestamp-deteccao" value="" required>
            </div>
            <div class="form-group">
                <label class="label-required">Equipe Responsável Inicial</label>
                <select id="equipe-responsavel" required>
                    <option value=""></option>
                    <option selected>Selecione a equipe...</option>
                    <option>TRI - Tratamento de Respostas a Incidentes</option>
                    <option>NOC - Network Operations Center</option>
                    <option>SOC - Security Operations Center</option>
                    <option>CPD - Administradores de Sistema</option>
                    <option>CSIRT - Computer Security Incident Response Team</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="label-required">Vetor Principal do Ataque</label>
                <select id="vetor-ataque" required>
                    <option value="">
                        <option selected>Escolha o diagnóstico...
                    </option>
                    <option >Ataque de Amplificação (DNS/NTP)</option>
                    <option>Ataque de Camada 7 (HTTP/API)</option>
                    <option>Ataque de Protocolo (SYN/ACK Flood)</option>
                    <option>Ataque Volumétrico Bruto (UDP/ICMP Flood)</option>
                    <option>Ataque de Exaustão (SSL/CPU)</option>
                    <option>Ataque de Camada 2 (Interno/LAN)</option>
                    <option>Multi-Vetorial (Combinado)</option>
                </select>
            </div>
            <div class="form-group">
                <label class="label-required">Volume Estimado (Pico)</label>
                <input type="text" id="volume-ataque" placeholder="Ex: 80 Gbps / 20 Mpps" value="" required>
            </div>
            <div class="form-group">
                <label class="label-required">Severidade</label>
                <select id="severidade" required>
                    <option selected> Escolha  o grau de severidade</option>
                    <option>Crítica (Serviço Offline) - Nível 3</option>
                    <option>Alta (Degradação Grave) - Nível 2</option>
                    <option>Média (Instabilidade) - Nível 1</option>
                    <option>Baixa (Pouco impacto) </option>
                </select>
            </div>
            
            <div class="form-group full-width-3">
                <label>Serviços da UFRGS  (Múltipla escolha)</label>
                <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
                    <label class="checkbox-item"><input type="checkbox" class="servico" value="portal-aluno"> Portal do Aluno (portal.ufrgs.br)</label>
                    <label class="checkbox-item"><input type="checkbox" class="servico" value="moodle"> Moodle EaD (moodle.ufrgs.br)</label>
                    <label class="checkbox-item"><input type="checkbox" class="servico" value="sei"> SEI (sei.ufrgs.br)</label>
                    <label class="checkbox-item"><input type="checkbox" class="servico" value="email"> Email Institucional</label>
                    <label class="checkbox-item"><input type="checkbox" class="servico" value="biblioteca"> Biblioteca Digital</label>
                    <label class="checkbox-item"><input type="checkbox" class="servico" value="vpn"> VPN de Acesso Remoto</label>
                </div>
            </div>
        </div>
    </div>

    <!-- SEÇÃO 2: EQUIPE DE RESPOSTA E RESPONSABILIDADES -->
    <div class="section">
        <div class="section-header">
            <span><i class="fas fa-users"></i> EQUIPE DE RESPOSTA E RESPONSABILIDADES</span>
            <span class="status-indicator status-high">EQUIPE ATIVA</span>
        </div>
        
        <div class="profissionais-container">
            <!-- Analista de Rede -->
            <div class="profissional-card">
                <div class="profissional-header">
                    <div class="profissional-icon">
                        <i class="fas fa-network-wired"></i>
                    </div>
                    <div>
                        <div class="profissional-nome">
                            <input type="text" class="nome-input profissional-nome-input" placeholder="Digite o nome do profissional" value="">
                        </div>
                        <div class="profissional-funcao">Analista de Redes - Nível 3</div>
                    </div>
                </div>
                <div class="profissional-tarefas">
                    <strong>Tarefas durante incidente:</strong>
                    <ul>
                        <li>Monitorar saturação de links (MRTG/PRTG)</li>
                        <li>Aplicar ACLs para bloquear IPs maliciosos</li>
                        <li>Configurar BGP blackholing com ISP</li>
                        <li>Analisar NetFlow para identificar origem</li>
                        <li>Coordenar failover de links</li>
                    </ul>
                </div>
            </div>
            
            <!-- Administrador de Sistemas -->
            <div class="profissional-card">
                <div class="profissional-header">
                    <div class="profissional-icon">
                        <i class="fas fa-server"></i>
                    </div>
                    <div>
                        <div class="profissional-nome">
                            <input type="text" class="nome-input profissional-nome-input" placeholder="Digite o nome do profissional" value="">
                        </div>
                        <div class="profissional-funcao">Administrador(a) de Sistemas</div>
                    </div>
                </div>
                <div class="profissional-tarefas">
                    <strong>Tarefas durante incidente:</strong>
                    <ul>
                        <li>Monitorar CPU/RAM dos servidores críticos</li>
                        <li>Reiniciar serviços travados (Apache/Nginx)</li>
                        <li>Limpar conexões zombies (netstat, kill)</li>
                        <li>Aplicar rate limiting em aplicações</li>
                        <li>Validar integridade de bancos de dados</li>
                    </ul>
                </div>
            </div>
            
            <!-- Analista de Segurança -->
            <div class="profissional-card">
                <div class="profissional-header">
                    <div class="profissional-icon">
                        <i class="fas fa-shield-alt"></i>
                    </div>
                    <div>
                        <div class="profissional-nome">
                            <input type="text" class="nome-input profissional-nome-input" placeholder="Digite o nome do profissional" value="">
                        </div>
                        <div class="profissional-funcao">Analista de Segurança - CSIRT</div>
                    </div>
                </div>
                <div class="profissional-tarefas">
                    <strong>Tarefas durante incidente:</strong>
                    <ul>
                        <li>Analisar logs de WAF/IPS</li>
                        <li>Configurar regras de mitigação no WAF</li>
                        <li>Coordenar com provedor de scrubbing</li>
                        <li>Documentar evidências forenses</li>
                        <li>Comunicar-se com gestão sobre impacto</li>
                    </ul>
                </div>
            </div>
            
            <!-- Gestor de Infraestrutura -->
            <div class="profissional-card">
                <div class="profissional-header">
                    <div class="profissional-icon">
                        <i class="fas fa-user-tie"></i>
                    </div>
                    <div>
                        <div class="profissional-nome">
                            <input type="text" class="nome-input profissional-nome-input" placeholder="Digite o nome do profissional" value="">
                        </div>
                        <div class="profissional-funcao">Gestor(a) de Infraestrutura</div>
                    </div>
                </div>
                <div class="profissional-tarefas">
                    <strong>Tarefas durante incidente:</strong>
                    <ul>
                        <li>Tomar decisões estratégicas de mitigação</li>
                        <li>Comunicar-se com diretoria da UFRGS</li>
                        <li>Autorizar gastos com serviços emergenciais</li>
                        <li>Coordenar comunicação com usuários</li>
                        <li>Aprovar plano de recuperação</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div style="margin-top: 20px;">
            <div class="grid">
                <div class="form-group">
                    <label>Profissional Responsável pela Documentação</label>
                    <input type="text" id="responsavel-documentacao" class="nome-input" placeholder="Digite o nome e cargo" value="">
                   
                </div>
                <div class="form-group">
                    <label>Data de Atribuição da Equipe</label>
                    <input type="date" id="data-atribuicao" value="">
                </div>
            </div>
            
            <div style="margin-top: 15px;">
                <label>Adicionar Novo Profissional à Equipe</label>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <input type="text" id="novoProfissionalNome" placeholder="Nome do profissional" style="flex: 2;">
                    <select id="novoProfissionalFuncao" style="flex: 1;">
                        <option value="">Selecione a função...</option>
                        <option value="analista">Analista de Redes</option>
                        <option value="sysadmin">Administrador de Sistemas</option>
                        <option value="seguranca">Analista de Segurança</option>
                        <option value="gestor">Gestor</option>
                        <option value="outro">Outro</option>
                    </select>
                    <button type="button" class="btn-add" onclick="adicionarProfissional()">
                        <i class="fas fa-plus"></i> Adicionar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- SEÇÃO 3: LINHA DO TEMPO DO INCIDENTE -->
    <div class="section">
        <div class="section-header">
            <span><i class="fas fa-clock"></i> LINHA DO TEMPO - TIMESTAMPS CRÍTICOS</span>
            <span class="status-indicator status-medium">EM MONITORAMENTO</span>
        </div>
        
        <div class="timeline-container">
            <div class="timeline-item">
                <div class="timeline-time"><i class="fas fa-exclamation-triangle"></i> Primeira detecção</div>
                <div class="timeline-description">Sistema detecta aumento de 500% no tráfego de entrada. Alertas enviados para NOC.</div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-time"><i class="fas fa-bell"></i> Validação do incidente</div>
                <div class="timeline-description">Equipe NOC confirma ataque DDoS via análise NetFlow. Classificado como Nível 2 (Alta severidade).</div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-time"><i class="fas fa-user-shield"></i>  Acionamento do CSIRT</div>
                <div class="timeline-description">CSIRT notificado via SaaS. Bridge de conferência estabelecida.</div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-time"><i class="fas fa-cloud"></i>   Mitigação com provedor</div>
                <div class="timeline-description">Scrubbing ativado. Tráfego redirecionado para limpeza.</div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-time"><i class="fas fa-chart-line"></i>  Pico do ataque</div>
                <div class="timeline-description">Volume atinge 15.2 Gbps. 98% do link principal saturado.</div>
            </div>
            
            <div class="timeline-item">
                <div class="timeline-time"><i class="fas fa-check-circle"></i>  Início da recuperação</div>
                <div class="timeline-description">Tráfego malicioso reduzido em 90%. Serviços começam a normalizar.</div>
            </div>
        </div>
        
        <div class="grid" style="margin-top: 25px;">
            <div class="form-group">
                <label>Timestamp de Contenção Efetiva</label>
                <input type="datetime-local" id="timestamp-contencao" value="">
            </div>
            <div class="form-group">
                <label>Timestamp de Restauração Completa</label>
                <input type="datetime-local" id="timestamp-restauracao" value="">
            </div>
        </div>
    </div>

    <!-- SEÇÃO 4: AÇÕES DE MITIGAÇÃO APLICADAS -->
    <div class="section">
        <div class="section-header">
            <span><i class="fas fa-tools"></i> AÇÕES DE MITIGAÇÃO APLICADAS (POR VETOR)</span>
            <span class="status-indicator status-resolved">MITIGAÇÃO ATIVA</span>
        </div>
        <div class="grid">
            
            <div class="mitigation-panel">
                <span class="mitigation-title"><i class="fas fa-broadcast-tower"></i> Amplificação / Reflexão</span>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="bloqueio-udp"> Bloqueio de portas UDP (53, 123, 11211)</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value=""> Implementação de BCP38 (Anti-Spoofing)</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="blackholing"> Acionamento de Upstream Blackholing</label>
                </div>
            </div>

            <div class="mitigation-panel">
                <span class="mitigation-title"><i class="fas fa-globe"></i> Camada de Aplicação (L7)</span>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="waf"> Ativação de WAF (Inspeção L7)</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="captcha"> Desafios CAPTCHA / JavaScript</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="timeouts"> Redução de Timeouts (Anti-Slowloris)</label>
                </div>
            </div>

            <div class="mitigation-panel">
                <span class="mitigation-title"><i class="fas fa-exchange-alt"></i> Protocolo / Estado</span>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="syn-cookies"> Habilitação de SYN Cookies</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="keep-alive"> Ajuste de TCP Keep-Alive</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="hardening"> Hardening de Tabela de Estado</label>
                </div>
            </div>

            <div class="mitigation-panel">
                <span class="mitigation-title"><i class="fas fa-tachometer-alt"></i> Volumétrico Direto</span>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value=""> Redirecionamento Scrubbing Center</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value=""> Rate Limiting (ICMP/Ping)</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value=""> Bloqueio Geográfico (Geo-IP)</label>
                </div>
            </div>

            <div class="mitigation-panel">
                <span class="mitigation-title"><i class="fas fa-microchip"></i> Exaustão de Recursos</span>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="ssl-offloading"> SSL Offloading (CDN/LB)</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="circuit-breaker"> Circuit Breaker (Função Crítica)</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="priorizacao"> Priorização de Fila Autenticada</label>
                </div>
            </div>

            <div class="mitigation-panel">
                <span class="mitigation-title"><i class="fas fa-sitemap"></i> Camada 2 (Interno)</span>
                <div class="checkbox-group">
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="port-security"> Port Security nos Switches</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="limpeza-arp"> Limpeza de Tabelas ARP/MAC</label>
                    <label class="checkbox-item"><input type="checkbox" class="mitigacao" value="segmentacao"> Segmentação por VLAN</label>
                </div>
            </div>
            <div class="form-group">
                <label class="label-required">Outras Ações ou Resposta Integrada (Multi-vetorial)</label>
                <select id="outras-acoes" required>
                    <option selected>Selecione uma opção...</option>
                    <option>Coordenação com Cloudflare para ativação de modo "Under Attack"</option>
                    <option>Ajuste de rate limiting no NGINX para endpoints críticos (/api, /login)</option>
                    <option>Comunicação com Vivo/Claro para blackholing de IPs específicos</option>
                    <option>Logs do Apache</option>
                    <option>Ativação de link backup para distribuição de carga</option>
                </select>
            </div>
        </div>
    </div>

    <!-- SEÇÃO 5: EVIDÊNCIAS TÉCNICAS E FORENSES -->
    <div class="section">
        <div class="section-header">
            <span><i class="fas fa-clipboard-list"></i>  EVIDÊNCIAS TÉCNICAS E FORENSES</span>
            <span class="status-indicator status-medium">COLETADAS</span>
        </div>
        <div class="form-group">
            <label class="label-required">Logs e Artefatos Coletados (Forense de Rede)</label>
            <select id="logs-coletados" required>
                <option selected>Selecione uma opção...</option>
                <option>PCAP completo</option>
                <option>NetFlow analysis: Top 10 ASNs atacantes (China Telecom, Level3, NTT)</option>
                <option>Grafana dashboards: Pico de 15.2 Gbps às 15:10</option>
                <option>Logs do Apache</option>
                <option>Monitoração da infra estrutura, ex: Zabbix.</option>
            </select>
        </div>

        <div class="form-group">
            <label class="label-required">Responsável Técnico pela Coleta</label>
            <input type="text" id="responsavel-coleta" class="nome-input" placeholder="Nome - Cargo" value="" required>
        </div>
        <div class="form-group">
            <label class="label-required">Status da Recuperação</label>
            <select id="status-recuperacao" required>
                <option selected>Selecione uma opção...</option>
                <option>Totalmente Restabelecido</option>
                <option>Parcial / Monitoramento Reforçado</option>
                <option>Sob Mitigação (Contenção Ativa)</option>
            </select>
        </div>
        
        <div class="form-group full-width">
            <label>Local de Armazenamento das Evidências</label>
            <input type="text" id="local-armazenamento" class="nome-input" placeholder="Digite o local de armazenamento" value="">
        </div>
    </div>

    <!-- SEÇÃO 6: ANÁLISE DE IMPACTO E MÉTRICAS -->
    <div class="section">
        <div class="section-header">
            <span><i class="fas fa-chart-bar"></i> ANÁLISE DE IMPACTO E MÉTRICAS</span>
            <span class="status-indicator status-critical">IMPACTO ALTO</span>
        </div>
            <div class="form-group">
                <label>Tempo Total de Indisponibilidade (TTI)</label>
                <input type="text" class="nome-input" placeholder="Ex.: 1 hora e 15 minutos" value="">
            </div>
            <div class="form-group">
                <label>Usuários Afetados (Estimativa)</label>
                <input type="text" class="nome-input" placeholder="Ex.: ~25.000 usuários"  value="">
            </div>
            <div class="form-group">
                <label>Custo Estimado do Downtime</label>
                <input type="text" class="nome-input" placeholder="Ex.:R$ 18.750,00 (25h de trabalho técnico)" value="">
            </div>
            
            <div class="form-group">
                <label>MTTD (Tempo Médio de Detecção)</label>
                <input type="text" class="nome-input" placeholder="Ex.: 5 minutos 21 segundos" value="">
            </div>

            <div class="form-group">
                <label>MTTR (Tempo Médio de Resposta)</label>
                <input type="text" class="nome-input" placeholder="Ex.:15 minutos 30 segundos" value="">
            </div>
            <div class="form-group">
                <label>MTBF (Tempo Médio entre Falhas)</label>
                <input type="text" class="nome-input" placeholder="Digite a data estimada do ultimo incidente" value="">
            </div>
            <label class="label-required">Análise de Tendência e Recomendações</label>
                <select required>
                    
                    <option selected>Selecione uma opção...</option>
                    
                    <option>Implementar CDN always-on</option>
                    <option>Revisar thresholds de alerta</option>
                    <option>Realizar testes de mitigação trimestrais</option>
                    <option>Capacitar equipe em resposta a ataques L7</option>

                </select>
            </div>     
           
        </div>
    </div>

    <!-- SEÇÃO 7: LIÇÕES APRENDIDAS E PLANO DE MELHORIA -->
    <div class="section">
        <div class="section-header">
            <span><i class="fas fa-graduation-cap"></i> LIÇÕES APRENDIDAS E PLANO DE MELHORIA</span>
            <span class="status-indicator status-high">EM ANÁLISE</span>
        </div>
        
        <div class="grid">
            <!-- Causa Raiz -->
            <div class="form-group full-width">
                <label class="label-required">Causa Raiz Identificada, qual lacuna permitiu o impacto? (Ex: Falta de proteção de borda, limite de conexões baixo...)</label>
                <select id="causa-raiz" required>
                    <option selected>Selecione uma opção...</option>
                    <option>Thresholds de alerta muito altos (90% do link) - deveria ser 70%</option>
                    <option>Falta de WAF específico para endpoints de API (/api/search)</option>
                    <option>Playbook de resposta não incluía procedimento para ataques de amplificação DNS</option>
                    <option>Comunicação com gestão foi lenta (20 minutos para escalar)</option>
                </select>
            </div>
            
            <!-- Plano de Melhoria -->
            <div class="form-group full-width">
                <label class="label-required">Plano de Melhoria (Action Items)</label>
                <div class="action-items-container">
                    <!-- Item 1 -->
                    <div class="action-item">
                        <div class="grid" style="gap: 10px;">
                            <div style="grid-column: span 2;">
                                <label>Item de Ação </label>
                                <textarea class="acao-descricao" placeholder="Descreva a ação de melhoria..." rows="2" style="width: 100%;"></textarea>
                            </div>
                            <div>
                                <label>Responsável</label>
                                <input type="text" class="nome-input acao-responsavel" placeholder="Digite o nome" value="">
                            </div>
                            <div>
                                <label>Prazo</label>
                                <select class="acao-prazo" style="width: 100%;">
                                    <option selected> Dias</option>
                                    <option >7 dias</option>
                                    <option>15 dias</option>
                                    <option>30 dias</option>
                                    <option>60 dias</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Item 2 -->
                    <div class="action-item" style="border-left-color: var(--cor-alerta);">
                        <div class="grid" style="gap: 10px;">
                            <div style="grid-column: span 2;">
                                <label>Item de Ação </label>
                                <textarea class="acao-descricao" placeholder="Descreva a ação de melhoria..." rows="2" style="width: 100%;"></textarea>
                            </div>
                            <div>
                                <label>Responsável</label>
                                <input type="text" class="nome-input acao-responsavel" placeholder="Digite o nome" value="">
                            </div>
                            <div>
                                <label>Prazo</label>
                                <select class="acao-prazo" style="width: 100%;">
                                    <option selected>Dias</option>
                                    <option>7 dias</option>
                                    <option>14 dias</option>
                                    <option>30 dias</option>
                                    <option>60 dias</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Item 3 -->
                    <div class="action-item" style="border-left-color: var(--cor-info);">
                        <div class="grid" style="gap: 10px;">
                            <div style="grid-column: span 2;">
                                <label>Item de Ação </label>
                                <textarea class="acao-descricao" placeholder="Descreva a ação de melhoria..." rows="2" style="width: 100%;"></textarea>
                            </div>
                            <div>
                                <label>Responsável</label>
                                <input type="text" class="nome-input acao-responsavel" placeholder="Digite o nome" value="">
                            </div>
                            <div>
                                <label>Prazo</label>
                                <select class="acao-prazo" style="width: 100%;">
                                    <option selected> Dias</option>
                                    <option >7 dias</option>
                                    <option>14 dias</option>
                                    <option >30 dias</option>
                                    <option>60 dias</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Botão para adicionar novo item -->
                <button type="button" class="btn-add" onclick="adicionarItemAcao()" style="margin-top: 15px;">
                    <i class="fas fa-plus-circle"></i> Adicionar Novo Item de Ação
                </button>
            </div>
            
            <!-- Responsável Geral e Data de Revisão -->
            <div class="grid">
                <div class="form-group">
                    <label>Responsável Geral pelo Plano</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="responsavel-geral-nome" class="nome-input" placeholder="Nome do responsável" value="" style="flex: 1;">
                        <input type="text" id="responsavel-geral-cargo" class="nome-input" placeholder="Cargo" value="" style="flex: 1;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Data de Revisão do Plano</label>
                    <input type="date" id="data-revisao" value="">
                </div>
            </div>
            
            <!-- Assinaturas -->
            <div class="form-group full-width">
                <label>Assinaturas de Aprovação</label>
                <div class="grid-3" style="gap: 15px; margin-top: 10px;">
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 6px; text-align: center;">
                        <label>Responsável Técnico</label>
                        <input type="text" id="assinatura-tecnico" class="nome-input" placeholder="Nome e assinatura" value="" style="width: 100%; margin-top: 5px; text-align: center; background: transparent; border: none; border-bottom: 1px dashed var(--cor-borda);">
                        <div style="font-size: 11px; color: #666; margin-top: 5px;">Analista de Segurança - CSIRT</div>
                    </div>
                    
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 6px; text-align: center;">
                        <label>Gestor de Infraestrutura</label>
                        <input type="text" id="assinatura-gestor" class="nome-input" placeholder="Nome e assinatura" value="" style="width: 100%; margin-top: 5px; text-align: center; background: transparent; border: none; border-bottom: 1px dashed var(--cor-borda);">
                        <div style="font-size: 11px; color: #666; margin-top: 5px;">Gestora de Infraestrutura</div>
                    </div>
                    
                    <div style="padding: 15px; background: #f8f9fa; border-radius: 6px; text-align: center;">
                        <label>Diretor de TI</label>
                        <input type="text" id="assinatura-diretor" class="nome-input" placeholder="Nome e assinatura" value="" style="width: 100%; margin-top: 5px; text-align: center; background: transparent; border: none; border-bottom: 1px dashed var(--cor-borda);">
                        <div style="font-size: 11px; color: #666; margin-top: 5px;">Diretor de Tecnologia da Informação</div>
                    </div>
                </div>
            </div>
            
            <!-- Status de Implementação -->
            <div class="form-group full-width">
                <label>Status de Implementação do Plano</label>
                <div style="display: flex; gap: 15px; margin-top: 10px;">
                    <label class="checkbox-item" style="flex: 1;">
                        <input type="radio" name="status-plano" value="em-andamento"> 
                        <div>
                            <strong>Em Andamento</strong>
                            <div style="font-size: 12px; color: #666;">Ações sendo implementadas</div>
                        </div>
                    </label>
                    <label class="checkbox-item" style="flex: 1;">
                        <input type="radio" name="status-plano" value="parcial" > 
                        <div>
                            <strong>Parcialmente Concluído</strong>
                            <div style="font-size: 12px; color: #666;">Algumas ações finalizadas</div>
                        </div>
                    </label>
                    <label class="checkbox-item" style="flex: 1;">
                        <input type="radio" name="status-plano" value="concluido"> 
                        <div>
                            <strong>Concluído</strong>
                            <div style="font-size: 12px; color: #666;">Todas ações implementadas</div>
                        </div>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- BOTÕES DE AÇÃO -->
    <div class="btn-container">
        <div>
            <strong>Status do Formulário:</strong>
            <span class="status-indicator status-high" style="margin-left: 10px;">RASCUNHO - NÃO ENVIADO</span>
        </div>
        
        <div class="btn-group">
            <button type="reset" class="btn-clear">
                <i class="fas fa-eraser"></i> Limpar Tudo
            </button>
            <button type="button" class="btn-relatorio" onclick="gerarRelatorioCompleto()">
                <i class="fas fa-file-alt"></i> Gerar Relatório
            </button>
        </div>
    </div>
</div>
</form>

<script>
    // Função para gerar relatório completo - CORRIGIDA
    function gerarRelatorioCompleto() {
        console.log("Função gerarRelatorioCompleto() chamada");
        
        // Validar campos obrigatórios primeiro
        const requiredFields = document.querySelectorAll('[required]');
        let isValid = true;
        const missingFields = [];
        
        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                field.style.borderColor = '#e74c3c';
                isValid = false;
                missingFields.push(field.previousElementSibling?.textContent || 'Campo obrigatório');
            } else {
                field.style.borderColor = '';
            }
        });
        
        if (!isValid) {
            alert('Por favor, preencha todos os campos obrigatórios antes de gerar o relatório.\n\nCampos faltando:\n- ' + missingFields.join('\n- '));
            return;
        }
        
        // Coletar dados do formulário
        const incidentId = document.getElementById('id-incidente').value;
        const timestamp = new Date().toLocaleString('pt-BR');
        const responsavel = document.getElementById('responsavel-documentacao').value || 'Responsável não informado';
        
        // Preparar para impressão/PDF
        const originalTitle = document.title;
        document.title = `Relatório DDoS - ${incidentId} - ${timestamp}`;
        
        // Criar uma cópia do container para impressão
        const container = document.querySelector('.container');
        const originalContainerHTML = container.innerHTML;
        
        // Adicionar cabeçalho de relatório
        const printHeader = `
            <div style="text-align: center; margin-bottom: 30px; border-bottom: 3px solid #2c3e50; padding-bottom: 20px; page-break-after: avoid;">
                <h1 style="color: #2c3e50; margin-bottom: 10px;">Registro de Incidentes</h1>
                <h3 style="color: #34495e; margin-top: 0;">UFRGS - Centro de Processamento de Dados</h3>
                <div style="display: flex; justify-content: center; gap: 30px; margin-top: 15px; font-size: 14px;">
                    <div><strong>ID do Incidente:</strong> ${incidentId}</div>
                    <div><strong>Data do Relatório:</strong> ${timestamp}</div>
                    <div><strong>Responsável:</strong> ${responsavel}</div>
                </div>
            </div>
        `;
        
        // Adicionar rodapé para impressão
        const printFooter = `
            <div style="text-align: center; margin-top: 50px; padding-top: 20px; border-top: 1px solid #ddd; font-size: 12px; color: #666; page-break-before: avoid;">
                <p>Relatório gerado automaticamente pelo Sistema de Gestão de Incidentes de Segurança - UFRGS</p>
                <p>Documento confidencial - Uso interno</p>
                <p>Página gerada em: ${new Date().toLocaleString('pt-BR')}</p>
            </div>
        `;
        
        // Substituir temporariamente o conteúdo
        container.innerHTML = printHeader + originalContainerHTML + printFooter;
        
        // Esconder botões e introdução para impressão
        const btnContainer = document.querySelector('.btn-container');
        const introducao = document.querySelector('.introducao');
        if (btnContainer) btnContainer.style.display = 'none';
        if (introducao) introducao.style.display = 'none';
        
        // Aplicar estilos específicos para impressão
        const sections = document.querySelectorAll('.section');
        sections.forEach(section => {
            section.style.breakInside = 'avoid';
            section.style.pageBreakInside = 'avoid';
        });
        
        // Imprimir
        window.print();
        
        // Restaurar o conteúdo original
        container.innerHTML = originalContainerHTML;
        
        // Restaurar título
        document.title = originalTitle;
        
        // Mostrar botões novamente
        if (btnContainer) btnContainer.style.display = 'flex';
        if (introducao) introducao.style.display = 'block';
        
        // Atualizar status
        const statusIndicator = document.querySelector('.btn-container .status-indicator');
        statusIndicator.textContent = 'RELATÓRIO GERADO - ' + new Date().toLocaleTimeString();
        statusIndicator.className = 'status-indicator status-resolved';
        
        // Feedback para o usuário
        alert(`Relatório gerado com sucesso para o incidente ${incidentId}!\n\nO relatório foi preparado para impressão. Use as opções de impressão do navegador para salvar como PDF se necessário.`);
    }
    
    // Função para adicionar novo profissional
    function adicionarProfissional() {
        const nomeInput = document.getElementById('novoProfissionalNome');
        const funcaoSelect = document.getElementById('novoProfissionalFuncao');
        
        if (!nomeInput.value.trim()) {
            alert('Por favor, digite o nome do profissional');
            nomeInput.focus();
            return;
        }
        
        if (!funcaoSelect.value) {
            alert('Por favor, selecione a função do profissional');
            funcaoSelect.focus();
            return;
        }
        
        // Mapear funções para ícones
        const funcoesMap = {
            'analista': { icon: 'fa-network-wired', label: 'Analista de Redes' },
            'sysadmin': { icon: 'fa-server', label: 'Administrador de Sistemas' },
            'seguranca': { icon: 'fa-shield-alt', label: 'Analista de Segurança' },
            'gestor': { icon: 'fa-user-tie', label: 'Gestor de Infraestrutura' },
            'outro': { icon: 'fa-user', label: 'Outro' }
        };
        
        const funcaoInfo = funcoesMap[funcaoSelect.value] || funcoesMap.outro;
        
        // Criar novo card de profissional
        const novoCard = document.createElement('div');
        novoCard.className = 'profissional-card';
        novoCard.style.animation = 'fadeIn 0.5s ease-out';
        novoCard.innerHTML = `
            <div class="profissional-header">
                <div class="profissional-icon">
                    <i class="fas ${funcaoInfo.icon}"></i>
                </div>
                <div>
                    <div class="profissional-nome">
                        <input type="text" class="nome-input profissional-nome-input" placeholder="Digite o nome do profissional" 
                               value="${nomeInput.value}">
                    </div>
                    <div class="profissional-funcao">${funcaoInfo.label}</div>
                </div>
                <button type="button" onclick="removerProfissional(this)" 
                        style="margin-left: auto; background: none; border: none; color: var(--cor-destaque); cursor: pointer; font-size: 16px;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="profissional-tarefas">
                <strong>Tarefas durante incidente:</strong>
                <div style="margin-top: 10px;">
                    <textarea placeholder="Descreva as tarefas específicas deste profissional..." 
                              rows="3" style="width: 100%; font-size: 12px; padding: 8px;"></textarea>
                </div>
            </div>
        `;
        
        // Adicionar ao container
        document.querySelector('.profissionais-container').appendChild(novoCard);
        
        // Limpar campos
        nomeInput.value = '';
        funcaoSelect.value = '';
        
        // Feedback visual
        novoCard.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    // Função para remover profissional
    function removerProfissional(btn) {
        const card = btn.closest('.profissional-card');
        const nome = card.querySelector('.profissional-nome-input')?.value || 'este profissional';
        
        if (confirm(`Tem certeza que deseja remover ${nome} da equipe?`)) {
            card.style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => {
                card.remove();
                // Atualizar status se não houver mais profissionais
                if (document.querySelectorAll('.profissional-card').length === 0) {
                    const statusIndicator = document.querySelector('.section-header .status-indicator');
                    statusIndicator.textContent = 'EQUIPE NÃO DEFINIDA';
                    statusIndicator.className = 'status-indicator status-critical';
                }
            }, 300);
        }
    }
    
    // Função para adicionar novo item de ação
    function adicionarItemAcao() {
        const container = document.querySelector('.action-items-container');
        const itemCount = container.children.length + 1;
        
        // Cores para os itens (rotaciona entre as cores)
        const cores = ['var(--cor-destaque)', 'var(--cor-alerta)', 'var(--cor-info)', 'var(--cor-sucesso)'];
        const cor = cores[(itemCount - 1) % cores.length];
        
        // Criar novo item
        const novoItem = document.createElement('div');
        novoItem.className = 'action-item';
        novoItem.style.cssText = `border-left-color: ${cor}; animation: fadeIn 0.5s ease-out;`;
        
        novoItem.innerHTML = `
            <div class="grid" style="gap: 10px;">
                <div style="grid-column: span 2;">
                    <label>Item de Ação ${itemCount}</label>
                    <textarea class="acao-descricao" placeholder="Descreva a ação de melhoria..." rows="2" style="width: 100%;"></textarea>
                </div>
                <div>
                    <label>Responsável</label>
                    <input type="text" class="nome-input acao-responsavel" placeholder="Digite o nome" style="width: 100%;">
                </div>
                <div>
                    <label>Prazo</label>
                    <select class="acao-prazo" style="width: 100%;">
                        <option>7 dias</option>
                        <option>15 dias</option>
                        <option>30 dias</option>
                        <option>60 dias</option>
                        <option>90 dias</option>
                    </select>
                </div>
                <div style="grid-column: span 3; display: flex; justify-content: flex-end; align-items: center; margin-top: 10px;">
                    <button type="button" onclick="removerItemAcao(this)" class="btn-remove">
                        <i class="fas fa-trash"></i> Remover Item
                    </button>
                </div>
            </div>
        `;
        
        // Adicionar ao container
        container.appendChild(novoItem);
        
        // Rolar até o novo item
        novoItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
    
    // Função para remover item de ação
    function removerItemAcao(btn) {
        const item = btn.closest('.action-item');
        if (confirm('Tem certeza que deseja remover este item de ação?')) {
            item.style.animation = 'fadeOut 0.3s ease-out';
            setTimeout(() => {
                item.remove();
                // Reorganizar números dos itens restantes
                const items = document.querySelectorAll('.action-item');
                items.forEach((item, index) => {
                    const label = item.querySelector('label');
                    if (label) {
                        label.textContent = `Item de Ação ${index + 1}`;
                        
                        // Atualizar cores para manter o padrão
                        const cores = ['var(--cor-destaque)', 'var(--cor-alerta)', 'var(--cor-info)', 'var(--cor-sucesso)'];
                        const cor = cores[index % cores.length];
                        item.style.borderLeftColor = cor;
                    }
                });
            }, 300);
        }
    }
    
    // Carregar rascunho salvo (se existir)
    document.addEventListener('DOMContentLoaded', function() {
        const incidentId = "INC-DDoS-2024-001";
        const savedForm = localStorage.getItem(`ddos-form-${incidentId}`);
        
        if (savedForm) {
            if (confirm('Foi encontrado um rascunho salvo para este incidente. Deseja carregá-lo?')) {
                try {
                    const dados = JSON.parse(savedForm);
                    
                    // Preencher campos básicos
                    Object.keys(dados).forEach(key => {
                        const element = document.getElementById(key);
                        if (element && dados[key]) {
                            element.value = dados[key];
                        }
                    });
                    
                    console.log('Rascunho carregado com sucesso!');
                } catch (e) {
                    console.error('Erro ao carregar rascunho:', e);
                }
            }
        }
        
        // Atualizar timestamps automáticos se necessário
        const now = new Date();
        const datetimeInputs = document.querySelectorAll('input[type="datetime-local"]');
        datetimeInputs.forEach(input => {
            if (!input.value) {
                input.value = now.toISOString().slice(0, 16);
            }
        });
        
        // Definir data padrão para campos de data
        const dateInputs = document.querySelectorAll('input[type="date"]');
        dateInputs.forEach(input => {
            if (!input.value) {
                input.value = now.toISOString().slice(0, 10);
            }
        });
        
        // Calcular MTTD e MTTR automaticamente
        calcularMetricas();
    });
    
    // Função para calcular MTTD e MTTR
    function calcularMetricas() {
        const deteccao = document.getElementById('timestamp-deteccao').value;
        const contencao = document.getElementById('timestamp-contencao').value;
        const restauracao = document.getElementById('timestamp-restauracao').value;
        
        if (deteccao && contencao) {
            const deteccaoDate = new Date(deteccao);
            const contencaoDate = new Date(contencao);
            const diffMs = contencaoDate - deteccaoDate;
            const diffMins = Math.floor(diffMs / 60000);
            const diffSecs = Math.floor((diffMs % 60000) / 1000);
            
            document.getElementById('mttd').value = `${diffMins} minutos ${diffSecs} segundos`;
        }
        
        if (contencao && restauracao) {
            const contencaoDate = new Date(contencao);
            const restauracaoDate = new Date(restauracao);
            const diffMs = restauracaoDate - contencaoDate;
            const diffMins = Math.floor(diffMs / 60000);
            const diffSecs = Math.floor((diffMs % 60000) / 1000);
            
            document.getElementById('mttr').value = `${diffMins} minutos ${diffSecs} segundos`;
        }
        
        if (deteccao && restauracao) {
            const deteccaoDate = new Date(deteccao);
            const restauracaoDate = new Date(restauracao);
            const diffMs = restauracaoDate - deteccaoDate;
            const diffHours = Math.floor(diffMs / 3600000);
            const diffMins = Math.floor((diffMs % 3600000) / 60000);
            
            document.getElementById('tti').value = `${diffHours} horas e ${diffMins} minutos`;
        }
    }
    
    // Adicionar listeners para calcular métricas quando os timestamps mudarem
    document.getElementById('timestamp-deteccao').addEventListener('change', calcularMetricas);
    document.getElementById('timestamp-contencao').addEventListener('change', calcularMetricas);
    document.getElementById('timestamp-restauracao').addEventListener('change', calcularMetricas);
</script>

</body>
</html>